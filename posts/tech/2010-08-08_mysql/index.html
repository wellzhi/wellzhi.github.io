<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MySQL常用命令 | wellzhi</title>
<meta name=keywords content="MySQL,数据库,Docker,命令"><meta name=description content="MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。本文详细介绍了MySQL的常用命令，包括数据库操作、表操作、数据操作以及Docker容器管理等实用技巧。"><meta name=author content="wellzhi"><link rel=canonical href=https://wellzhi.github.io/posts/tech/2010-08-08_mysql/><link crossorigin=anonymous href=/assets/css/stylesheet.b54291e20a5b433add2181af00208e3e72d99f37b405cd9f3ff373c992518ba6.css integrity="sha256-tUKR4gpbQzrdIYGvACCOPnLZnze0Bc2fP/NzyZJRi6Y=" rel="preload stylesheet" as=style><script crossorigin=anonymous src=/assets/js/mermaid.min.af2e2ae7d64e037e8a582c3ba35b128209a6f8350c3825cda07833979e0d827c.js></script><link rel=icon href=https://wellzhi.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wellzhi.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wellzhi.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wellzhi.github.io/apple-touch-icon.png><link rel=mask-icon href=https://wellzhi.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wellzhi.github.io/posts/tech/2010-08-08_mysql/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://wellzhi.github.io/posts/tech/2010-08-08_mysql/"><meta property="og:site_name" content="wellzhi"><meta property="og:title" content="MySQL常用命令"><meta property="og:description" content="MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。本文详细介绍了MySQL的常用命令，包括数据库操作、表操作、数据操作以及Docker容器管理等实用技巧。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-08-08T00:00:00+08:00"><meta property="article:modified_time" content="2010-08-08T00:00:00+08:00"><meta property="article:tag" content="MySQL"><meta property="article:tag" content="数据库"><meta property="article:tag" content="Docker"><meta property="article:tag" content="命令"><meta name=twitter:card content="summary"><meta name=twitter:title content="MySQL常用命令"><meta name=twitter:description content="MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。本文详细介绍了MySQL的常用命令，包括数据库操作、表操作、数据操作以及Docker容器管理等实用技巧。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wellzhi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Tech","item":"https://wellzhi.github.io/posts/tech/"},{"@type":"ListItem","position":3,"name":"MySQL常用命令","item":"https://wellzhi.github.io/posts/tech/2010-08-08_mysql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MySQL常用命令","name":"MySQL常用命令","description":"MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。本文详细介绍了MySQL的常用命令，包括数据库操作、表操作、数据操作以及Docker容器管理等实用技巧。","keywords":["MySQL","数据库","Docker","命令"],"articleBody":"1. 简介 MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。MySQL 提供了强大的功能和灵活的配置选项，使得它成为了最流行的数据库之一。本文将详细介绍MySQL的常用命令。\n2. 连接与退出 2.1 连接MySQL # 连接本地MySQL mysql -u username -p # 连接远程MySQL mysql -h hostname -u username -p # 指定端口连接 mysql -h hostname -P 3306 -u username -p # 连接指定数据库 mysql -u username -p database_name 2.2 退出MySQL -- 退出MySQL EXIT; -- 或者 QUIT; -- 或者使用快捷键 \\q 3. 数据库操作 3.1 查看数据库 -- 显示所有数据库 SHOW DATABASES; -- 查看当前使用的数据库 SELECT DATABASE(); -- 查看数据库创建语句 SHOW CREATE DATABASE database_name; 3.2 创建数据库 -- 创建数据库 CREATE DATABASE database_name; -- 创建数据库并指定字符集 CREATE DATABASE database_name CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; -- 如果不存在则创建 CREATE DATABASE IF NOT EXISTS database_name; 3.3 使用数据库 -- 切换到指定数据库 USE database_name; 3.4 删除数据库 -- 删除数据库 DROP DATABASE database_name; -- 如果存在则删除 DROP DATABASE IF EXISTS database_name; 4. 表操作 4.1 查看表 -- 显示当前数据库中的所有表 SHOW TABLES; -- 显示表结构 DESC table_name; -- 或者 DESCRIBE table_name; -- 或者 SHOW COLUMNS FROM table_name; -- 查看表创建语句 SHOW CREATE TABLE table_name; -- 查看表状态信息 SHOW TABLE STATUS LIKE 'table_name'; 4.2 创建表 -- 创建基本表 CREATE TABLE users ( id INT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50) NOT NULL UNIQUE, email VARCHAR(100) NOT NULL, password VARCHAR(255) NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ); -- 创建表并指定存储引擎和字符集 CREATE TABLE products ( id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(100) NOT NULL, price DECIMAL(10,2) NOT NULL, description TEXT, category_id INT, INDEX idx_category (category_id), FOREIGN KEY (category_id) REFERENCES categories(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4; 4.3 修改表结构 -- 添加列 ALTER TABLE table_name ADD COLUMN column_name VARCHAR(50); -- 修改列类型 ALTER TABLE table_name MODIFY COLUMN column_name VARCHAR(100); -- 重命名列 ALTER TABLE table_name CHANGE old_column_name new_column_name VARCHAR(50); -- 删除列 ALTER TABLE table_name DROP COLUMN column_name; -- 添加索引 ALTER TABLE table_name ADD INDEX index_name (column_name); -- 添加主键 ALTER TABLE table_name ADD PRIMARY KEY (column_name); -- 删除索引 ALTER TABLE table_name DROP INDEX index_name; 4.4 删除表 -- 删除表 DROP TABLE table_name; -- 如果存在则删除 DROP TABLE IF EXISTS table_name; -- 清空表数据但保留表结构 TRUNCATE TABLE table_name; 5. 数据操作 5.1 插入数据 -- 插入单条记录 INSERT INTO users (username, email, password) VALUES ('john_doe', 'john@example.com', 'hashed_password'); -- 插入多条记录 INSERT INTO users (username, email, password) VALUES ('user1', 'user1@example.com', 'password1'), ('user2', 'user2@example.com', 'password2'), ('user3', 'user3@example.com', 'password3'); -- 插入或更新（如果主键冲突则更新） INSERT INTO users (id, username, email) VALUES (1, 'updated_user', 'updated@example.com') ON DUPLICATE KEY UPDATE username = VALUES(username), email = VALUES(email); 5.2 查询数据 -- 基本查询 SELECT * FROM users; -- 指定列查询 SELECT username, email FROM users; -- 条件查询 SELECT * FROM users WHERE id = 1; SELECT * FROM users WHERE username LIKE '%john%'; SELECT * FROM users WHERE created_at \u003e '2023-01-01'; -- 排序 SELECT * FROM users ORDER BY created_at DESC; SELECT * FROM users ORDER BY username ASC, id DESC; -- 限制结果数量 SELECT * FROM users LIMIT 10; SELECT * FROM users LIMIT 10 OFFSET 20; -- 分组和聚合 SELECT COUNT(*) FROM users; SELECT category_id, COUNT(*) as product_count FROM products GROUP BY category_id; -- 连接查询 SELECT u.username, p.name as product_name FROM users u JOIN orders o ON u.id = o.user_id JOIN products p ON o.product_id = p.id; 5.3 更新数据 -- 更新单条记录 UPDATE users SET email = 'newemail@example.com' WHERE id = 1; -- 更新多个字段 UPDATE users SET email = 'newemail@example.com', updated_at = NOW() WHERE id = 1; -- 批量更新 UPDATE products SET price = price * 1.1 WHERE category_id = 1; 5.4 删除数据 -- 删除指定记录 DELETE FROM users WHERE id = 1; -- 条件删除 DELETE FROM users WHERE created_at \u003c '2022-01-01'; -- 删除所有记录（保留表结构） DELETE FROM table_name; 6. 索引操作 -- 创建索引 CREATE INDEX idx_username ON users(username); CREATE UNIQUE INDEX idx_email ON users(email); CREATE INDEX idx_name_category ON products(name, category_id); -- 查看索引 SHOW INDEX FROM table_name; -- 删除索引 DROP INDEX index_name ON table_name; -- 分析表性能 EXPLAIN SELECT * FROM users WHERE username = 'john_doe'; 7. 用户和权限管理 -- 创建用户 CREATE USER 'newuser'@'localhost' IDENTIFIED BY 'password'; CREATE USER 'remoteuser'@'%' IDENTIFIED BY 'password'; -- 授权 GRANT ALL PRIVILEGES ON database_name.* TO 'username'@'localhost'; GRANT SELECT, INSERT, UPDATE ON table_name TO 'username'@'localhost'; -- 查看权限 SHOW GRANTS FOR 'username'@'localhost'; -- 撤销权限 REVOKE ALL PRIVILEGES ON database_name.* FROM 'username'@'localhost'; -- 刷新权限 FLUSH PRIVILEGES; -- 删除用户 DROP USER 'username'@'localhost'; -- 修改密码 ALTER USER 'username'@'localhost' IDENTIFIED BY 'new_password'; 8. 备份和恢复 8.1 数据备份 # 备份单个数据库 mysqldump -u username -p database_name \u003e backup.sql # 备份多个数据库 mysqldump -u username -p --databases db1 db2 \u003e backup.sql # 备份所有数据库 mysqldump -u username -p --all-databases \u003e all_backup.sql # 只备份表结构 mysqldump -u username -p --no-data database_name \u003e structure.sql # 只备份数据 mysqldump -u username -p --no-create-info database_name \u003e data.sql # 备份并压缩 mysqldump -u username -p database_name | gzip \u003e backup.sql.gz 8.2 数据恢复 # 恢复数据库 mysql -u username -p database_name \u003c backup.sql # 恢复压缩备份 gunzip \u003c backup.sql.gz | mysql -u username -p database_name MySQL Docker 容器管理 9.1 运行MySQL容器 # 基本运行 docker run --name mysql-container -e MYSQL_ROOT_PASSWORD=rootpassword -d mysql:8.0 # 指定端口和数据卷 docker run --name mysql-container \\ -e MYSQL_ROOT_PASSWORD=rootpassword \\ -e MYSQL_DATABASE=myapp \\ -e MYSQL_USER=appuser \\ -e MYSQL_PASSWORD=apppassword \\ -p 3306:3306 \\ -v mysql-data:/var/lib/mysql \\ -d mysql:8.0 # 使用配置文件 docker run --name mysql-container \\ -e MYSQL_ROOT_PASSWORD=rootpassword \\ -p 3306:3306 \\ -v /path/to/my.cnf:/etc/mysql/my.cnf \\ -v mysql-data:/var/lib/mysql \\ -d mysql:8.0 9.2 Docker Compose 配置 # docker-compose.yml version: '3.8' services: mysql: image: mysql:8.0 container_name: mysql-container restart: always environment: MYSQL_ROOT_PASSWORD: rootpassword MYSQL_DATABASE: myapp MYSQL_USER: appuser MYSQL_PASSWORD: apppassword ports: - \"3306:3306\" volumes: - mysql-data:/var/lib/mysql - ./mysql-config:/etc/mysql/conf.d - ./init-scripts:/docker-entrypoint-initdb.d networks: - app-network volumes: mysql-data: networks: app-network: driver: bridge 9.3 容器管理命令 # 启动容器 docker start mysql-container # 停止容器 docker stop mysql-container # 重启容器 docker restart mysql-container # 查看容器状态 docker ps docker ps -a # 查看容器日志 docker logs mysql-container docker logs -f mysql-container # 实时查看 # 进入容器 docker exec -it mysql-container bash docker exec -it mysql-container mysql -u root -p # 删除容器 docker rm mysql-container docker rm -f mysql-container # 强制删除 9.4 数据备份和恢复（Docker） # 备份数据库 docker exec mysql-container mysqldump -u root -prootpassword myapp \u003e backup.sql # 恢复数据库 docker exec -i mysql-container mysql -u root -prootpassword myapp \u003c backup.sql # 备份数据卷 docker run --rm -v mysql-data:/data -v $(pwd):/backup alpine tar czf /backup/mysql-backup.tar.gz -C /data . # 恢复数据卷 docker run --rm -v mysql-data:/data -v $(pwd):/backup alpine tar xzf /backup/mysql-backup.tar.gz -C /data 10. 性能优化和监控 10.1 查看系统状态 -- 查看MySQL版本 SELECT VERSION(); -- 查看系统变量 SHOW VARIABLES LIKE 'innodb%'; SHOW VARIABLES LIKE 'max_connections'; -- 查看系统状态 SHOW STATUS LIKE 'Threads_connected'; SHOW STATUS LIKE 'Slow_queries'; -- 查看进程列表 SHOW PROCESSLIST; SHOW FULL PROCESSLIST; -- 查看InnoDB状态 SHOW ENGINE INNODB STATUS; 10.2 慢查询分析 -- 开启慢查询日志 SET GLOBAL slow_query_log = 'ON'; SET GLOBAL long_query_time = 2; -- 查看慢查询配置 SHOW VARIABLES LIKE 'slow_query%'; SHOW VARIABLES LIKE 'long_query_time'; 10.3 常用配置优化 # my.cnf 配置示例 [mysqld] # 基本配置 port = 3306 socket = /var/lib/mysql/mysql.sock # 字符集 character-set-server = utf8mb4 collation-server = utf8mb4_unicode_ci # 连接配置 max_connections = 200 max_connect_errors = 10 # 缓存配置 innodb_buffer_pool_size = 1G query_cache_size = 64M query_cache_type = 1 # 日志配置 log-error = /var/log/mysql/error.log slow_query_log = 1 slow_query_log_file = /var/log/mysql/slow.log long_query_time = 2 # InnoDB配置 innodb_file_per_table = 1 innodb_flush_log_at_trx_commit = 2 innodb_log_buffer_size = 16M innodb_log_file_size = 256M 11. 常用工具和技巧 11.1 MySQL客户端工具 # 使用mysql客户端 mysql -u username -p -h hostname -P port database_name # 执行SQL文件 mysql -u username -p database_name \u003c script.sql # 执行单条SQL命令 mysql -u username -p -e \"SELECT * FROM users LIMIT 5;\" # 输出为CSV格式 mysql -u username -p -e \"SELECT * FROM users;\" --batch --raw | sed 's/\\t/,/g' \u003e output.csv 11.2 实用技巧 -- 查看表大小 SELECT table_name, ROUND(((data_length + index_length) / 1024 / 1024), 2) AS 'Size (MB)' FROM information_schema.tables WHERE table_schema = 'database_name' ORDER BY (data_length + index_length) DESC; -- 查看数据库大小 SELECT table_schema AS 'Database', ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS 'Size (MB)' FROM information_schema.tables GROUP BY table_schema; -- 重置自增ID ALTER TABLE table_name AUTO_INCREMENT = 1; -- 查看表的自增值 SHOW TABLE STATUS LIKE 'table_name'; -- 修复表 REPAIR TABLE table_name; -- 优化表 OPTIMIZE TABLE table_name; -- 检查表 CHECK TABLE table_name; 12. 注意事项 安全第一：始终使用强密码，合理分配用户权限 定期备份：制定备份策略，确保数据安全 性能监控：定期检查慢查询，优化数据库性能 容器化部署：使用Docker简化MySQL的部署和管理 版本管理：保持MySQL版本更新，关注安全补丁 ","wordCount":"1246","inLanguage":"en","datePublished":"2010-08-08T00:00:00+08:00","dateModified":"2010-08-08T00:00:00+08:00","author":[{"@type":"Person","name":"wellzhi"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://wellzhi.github.io/posts/tech/2010-08-08_mysql/"},"publisher":{"@type":"Organization","name":"wellzhi","logo":{"@type":"ImageObject","url":"https://wellzhi.github.io/favicon.ico"}}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]]}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wellzhi.github.io/ accesskey=h title="wellzhi (Alt + H)">wellzhi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wellzhi.github.io/ title=Home><span>Home</span></a></li><li><a href=https://wellzhi.github.io/posts/ title=Post><span>Post</span></a></li><li><a href=https://wellzhi.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://wellzhi.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://wellzhi.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://wellzhi.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wellzhi.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://wellzhi.github.io/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://wellzhi.github.io/posts/tech/>Tech</a></div><h1 class="post-title entry-hint-parent">MySQL常用命令</h1></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-%e7%ae%80%e4%bb%8b aria-label="1. 简介">1. 简介</a></li><li><a href=#2-%e8%bf%9e%e6%8e%a5%e4%b8%8e%e9%80%80%e5%87%ba aria-label="2. 连接与退出">2. 连接与退出</a><ul><li><a href=#21-%e8%bf%9e%e6%8e%a5mysql aria-label="2.1 连接MySQL">2.1 连接MySQL</a></li><li><a href=#22-%e9%80%80%e5%87%bamysql aria-label="2.2 退出MySQL">2.2 退出MySQL</a></li></ul></li><li><a href=#3-%e6%95%b0%e6%8d%ae%e5%ba%93%e6%93%8d%e4%bd%9c aria-label="3. 数据库操作">3. 数据库操作</a><ul><li><a href=#31-%e6%9f%a5%e7%9c%8b%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label="3.1 查看数据库">3.1 查看数据库</a></li><li><a href=#32-%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label="3.2 创建数据库">3.2 创建数据库</a></li><li><a href=#33-%e4%bd%bf%e7%94%a8%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label="3.3 使用数据库">3.3 使用数据库</a></li><li><a href=#34-%e5%88%a0%e9%99%a4%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label="3.4 删除数据库">3.4 删除数据库</a></li></ul></li><li><a href=#4-%e8%a1%a8%e6%93%8d%e4%bd%9c aria-label="4. 表操作">4. 表操作</a><ul><li><a href=#41-%e6%9f%a5%e7%9c%8b%e8%a1%a8 aria-label="4.1 查看表">4.1 查看表</a></li><li><a href=#42-%e5%88%9b%e5%bb%ba%e8%a1%a8 aria-label="4.2 创建表">4.2 创建表</a></li><li><a href=#43-%e4%bf%ae%e6%94%b9%e8%a1%a8%e7%bb%93%e6%9e%84 aria-label="4.3 修改表结构">4.3 修改表结构</a></li><li><a href=#44-%e5%88%a0%e9%99%a4%e8%a1%a8 aria-label="4.4 删除表">4.4 删除表</a></li></ul></li><li><a href=#5-%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c aria-label="5. 数据操作">5. 数据操作</a><ul><li><a href=#51-%e6%8f%92%e5%85%a5%e6%95%b0%e6%8d%ae aria-label="5.1 插入数据">5.1 插入数据</a></li><li><a href=#52-%e6%9f%a5%e8%af%a2%e6%95%b0%e6%8d%ae aria-label="5.2 查询数据">5.2 查询数据</a></li><li><a href=#53-%e6%9b%b4%e6%96%b0%e6%95%b0%e6%8d%ae aria-label="5.3 更新数据">5.3 更新数据</a></li><li><a href=#54-%e5%88%a0%e9%99%a4%e6%95%b0%e6%8d%ae aria-label="5.4 删除数据">5.4 删除数据</a></li></ul></li><li><a href=#6-%e7%b4%a2%e5%bc%95%e6%93%8d%e4%bd%9c aria-label="6. 索引操作">6. 索引操作</a></li><li><a href=#7-%e7%94%a8%e6%88%b7%e5%92%8c%e6%9d%83%e9%99%90%e7%ae%a1%e7%90%86 aria-label="7. 用户和权限管理">7. 用户和权限管理</a></li><li><a href=#8-%e5%a4%87%e4%bb%bd%e5%92%8c%e6%81%a2%e5%a4%8d aria-label="8. 备份和恢复">8. 备份和恢复</a><ul><li><a href=#81-%e6%95%b0%e6%8d%ae%e5%a4%87%e4%bb%bd aria-label="8.1 数据备份">8.1 数据备份</a></li><li><a href=#82-%e6%95%b0%e6%8d%ae%e6%81%a2%e5%a4%8d aria-label="8.2 数据恢复">8.2 数据恢复</a></li></ul></li><li><a href=#mysql-docker-%e5%ae%b9%e5%99%a8%e7%ae%a1%e7%90%86 aria-label="MySQL Docker 容器管理">MySQL Docker 容器管理</a><ul><li><a href=#91-%e8%bf%90%e8%a1%8cmysql%e5%ae%b9%e5%99%a8 aria-label="9.1 运行MySQL容器">9.1 运行MySQL容器</a></li><li><a href=#92-docker-compose-%e9%85%8d%e7%bd%ae aria-label="9.2 Docker Compose 配置">9.2 Docker Compose 配置</a></li><li><a href=#93-%e5%ae%b9%e5%99%a8%e7%ae%a1%e7%90%86%e5%91%bd%e4%bb%a4 aria-label="9.3 容器管理命令">9.3 容器管理命令</a></li><li><a href=#94-%e6%95%b0%e6%8d%ae%e5%a4%87%e4%bb%bd%e5%92%8c%e6%81%a2%e5%a4%8ddocker aria-label="9.4 数据备份和恢复（Docker）">9.4 数据备份和恢复（Docker）</a></li></ul></li><li><a href=#10-%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%92%8c%e7%9b%91%e6%8e%a7 aria-label="10. 性能优化和监控">10. 性能优化和监控</a><ul><li><a href=#101-%e6%9f%a5%e7%9c%8b%e7%b3%bb%e7%bb%9f%e7%8a%b6%e6%80%81 aria-label="10.1 查看系统状态">10.1 查看系统状态</a></li><li><a href=#102-%e6%85%a2%e6%9f%a5%e8%af%a2%e5%88%86%e6%9e%90 aria-label="10.2 慢查询分析">10.2 慢查询分析</a></li><li><a href=#103-%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae%e4%bc%98%e5%8c%96 aria-label="10.3 常用配置优化">10.3 常用配置优化</a></li></ul></li><li><a href=#11-%e5%b8%b8%e7%94%a8%e5%b7%a5%e5%85%b7%e5%92%8c%e6%8a%80%e5%b7%a7 aria-label="11. 常用工具和技巧">11. 常用工具和技巧</a><ul><li><a href=#111-mysql%e5%ae%a2%e6%88%b7%e7%ab%af%e5%b7%a5%e5%85%b7 aria-label="11.1 MySQL客户端工具">11.1 MySQL客户端工具</a></li><li><a href=#112-%e5%ae%9e%e7%94%a8%e6%8a%80%e5%b7%a7 aria-label="11.2 实用技巧">11.2 实用技巧</a></li></ul></li><li><a href=#12-%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label="12. 注意事项">12. 注意事项</a></li></ul></div></details></div><div class=post-content><h2 id=1-简介>1. 简介<a hidden class=anchor aria-hidden=true href=#1-简介>#</a></h2><p>MySQL 是一个开源的关系型数据库管理系统，它被广泛用于 Web 应用程序的后端数据存储。MySQL 提供了强大的功能和灵活的配置选项，使得它成为了最流行的数据库之一。本文将详细介绍MySQL的常用命令。</p><h2 id=2-连接与退出>2. 连接与退出<a hidden class=anchor aria-hidden=true href=#2-连接与退出>#</a></h2><h3 id=21-连接mysql>2.1 连接MySQL<a hidden class=anchor aria-hidden=true href=#21-连接mysql>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 连接本地MySQL</span>
</span></span><span style=display:flex><span>mysql -u username -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接远程MySQL</span>
</span></span><span style=display:flex><span>mysql -h hostname -u username -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定端口连接</span>
</span></span><span style=display:flex><span>mysql -h hostname -P <span style=color:#ae81ff>3306</span> -u username -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接指定数据库</span>
</span></span><span style=display:flex><span>mysql -u username -p database_name
</span></span></code></pre></div><h3 id=22-退出mysql>2.2 退出MySQL<a hidden class=anchor aria-hidden=true href=#22-退出mysql>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 退出MySQL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>EXIT;
</span></span><span style=display:flex><span><span style=color:#75715e>-- 或者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>QUIT;
</span></span><span style=display:flex><span><span style=color:#75715e>-- 或者使用快捷键
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>\</span>q
</span></span></code></pre></div><h2 id=3-数据库操作>3. 数据库操作<a hidden class=anchor aria-hidden=true href=#3-数据库操作>#</a></h2><h3 id=31-查看数据库>3.1 查看数据库<a hidden class=anchor aria-hidden=true href=#31-查看数据库>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 显示所有数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> DATABASES;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看当前使用的数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>DATABASE</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看数据库创建语句
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> database_name;
</span></span></code></pre></div><h3 id=32-创建数据库>3.2 创建数据库<a hidden class=anchor aria-hidden=true href=#32-创建数据库>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 创建数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> database_name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 创建数据库并指定字符集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> database_name CHARACTER <span style=color:#66d9ef>SET</span> utf8mb4 <span style=color:#66d9ef>COLLATE</span> utf8mb4_unicode_ci;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 如果不存在则创建
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#66d9ef>IF</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>EXISTS</span> database_name;
</span></span></code></pre></div><h3 id=33-使用数据库>3.3 使用数据库<a hidden class=anchor aria-hidden=true href=#33-使用数据库>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 切换到指定数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>USE database_name;
</span></span></code></pre></div><h3 id=34-删除数据库>3.4 删除数据库<a hidden class=anchor aria-hidden=true href=#34-删除数据库>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 删除数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>DATABASE</span> database_name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 如果存在则删除
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#66d9ef>IF</span> <span style=color:#66d9ef>EXISTS</span> database_name;
</span></span></code></pre></div><h2 id=4-表操作>4. 表操作<a hidden class=anchor aria-hidden=true href=#4-表操作>#</a></h2><h3 id=41-查看表>4.1 查看表<a hidden class=anchor aria-hidden=true href=#41-查看表>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 显示当前数据库中的所有表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> TABLES;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 显示表结构
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DESC</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>-- 或者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DESCRIBE</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>-- 或者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> COLUMNS <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看表创建语句
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看表状态信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>TABLE</span> STATUS <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;table_name&#39;</span>;
</span></span></code></pre></div><h3 id=42-创建表>4.2 创建表<a hidden class=anchor aria-hidden=true href=#42-创建表>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 创建基本表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> users (
</span></span><span style=display:flex><span>    id INT AUTO_INCREMENT <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
</span></span><span style=display:flex><span>    username VARCHAR(<span style=color:#ae81ff>50</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>UNIQUE</span>,
</span></span><span style=display:flex><span>    email VARCHAR(<span style=color:#ae81ff>100</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    password VARCHAR(<span style=color:#ae81ff>255</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    created_at <span style=color:#66d9ef>TIMESTAMP</span> <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>CURRENT_TIMESTAMP</span>,
</span></span><span style=display:flex><span>    updated_at <span style=color:#66d9ef>TIMESTAMP</span> <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>CURRENT_TIMESTAMP</span> <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>CURRENT_TIMESTAMP</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 创建表并指定存储引擎和字符集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> products (
</span></span><span style=display:flex><span>    id INT AUTO_INCREMENT <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
</span></span><span style=display:flex><span>    name VARCHAR(<span style=color:#ae81ff>100</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    price DECIMAL(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    description TEXT,
</span></span><span style=display:flex><span>    category_id INT,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>INDEX</span> idx_category (category_id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (category_id) <span style=color:#66d9ef>REFERENCES</span> categories(id)
</span></span><span style=display:flex><span>) ENGINE<span style=color:#f92672>=</span>InnoDB <span style=color:#66d9ef>DEFAULT</span> CHARSET<span style=color:#f92672>=</span>utf8mb4;
</span></span></code></pre></div><h3 id=43-修改表结构>4.3 修改表结构<a hidden class=anchor aria-hidden=true href=#43-修改表结构>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 添加列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>COLUMN</span> <span style=color:#66d9ef>column_name</span> VARCHAR(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 修改列类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>MODIFY</span> <span style=color:#66d9ef>COLUMN</span> <span style=color:#66d9ef>column_name</span> VARCHAR(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 重命名列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> CHANGE old_column_name new_column_name VARCHAR(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 删除列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>COLUMN</span> <span style=color:#66d9ef>column_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 添加索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>INDEX</span> index_name (<span style=color:#66d9ef>column_name</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 添加主键
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#66d9ef>column_name</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 删除索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>INDEX</span> index_name;
</span></span></code></pre></div><h3 id=44-删除表>4.4 删除表<a hidden class=anchor aria-hidden=true href=#44-删除表>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 删除表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 如果存在则删除
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>IF</span> <span style=color:#66d9ef>EXISTS</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 清空表数据但保留表结构
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>TRUNCATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><h2 id=5-数据操作>5. 数据操作<a hidden class=anchor aria-hidden=true href=#5-数据操作>#</a></h2><h3 id=51-插入数据>5.1 插入数据<a hidden class=anchor aria-hidden=true href=#51-插入数据>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 插入单条记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> users (username, email, password) 
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;john_doe&#39;</span>, <span style=color:#e6db74>&#39;john@example.com&#39;</span>, <span style=color:#e6db74>&#39;hashed_password&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 插入多条记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> users (username, email, password) <span style=color:#66d9ef>VALUES</span> 
</span></span><span style=display:flex><span>(<span style=color:#e6db74>&#39;user1&#39;</span>, <span style=color:#e6db74>&#39;user1@example.com&#39;</span>, <span style=color:#e6db74>&#39;password1&#39;</span>),
</span></span><span style=display:flex><span>(<span style=color:#e6db74>&#39;user2&#39;</span>, <span style=color:#e6db74>&#39;user2@example.com&#39;</span>, <span style=color:#e6db74>&#39;password2&#39;</span>),
</span></span><span style=display:flex><span>(<span style=color:#e6db74>&#39;user3&#39;</span>, <span style=color:#e6db74>&#39;user3@example.com&#39;</span>, <span style=color:#e6db74>&#39;password3&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 插入或更新（如果主键冲突则更新）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> users (id, username, email) 
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;updated_user&#39;</span>, <span style=color:#e6db74>&#39;updated@example.com&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> DUPLICATE <span style=color:#66d9ef>KEY</span> <span style=color:#66d9ef>UPDATE</span> 
</span></span><span style=display:flex><span>username <span style=color:#f92672>=</span> <span style=color:#66d9ef>VALUES</span>(username), 
</span></span><span style=display:flex><span>email <span style=color:#f92672>=</span> <span style=color:#66d9ef>VALUES</span>(email);
</span></span></code></pre></div><h3 id=52-查询数据>5.2 查询数据<a hidden class=anchor aria-hidden=true href=#52-查询数据>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 基本查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 指定列查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> username, email <span style=color:#66d9ef>FROM</span> users;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 条件查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;%john%&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> created_at <span style=color:#f92672>&gt;</span> <span style=color:#e6db74>&#39;2023-01-01&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 排序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> created_at <span style=color:#66d9ef>DESC</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> username <span style=color:#66d9ef>ASC</span>, id <span style=color:#66d9ef>DESC</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 限制结果数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>OFFSET</span> <span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 分组和聚合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>FROM</span> users;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> category_id, <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>as</span> product_count 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> products 
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> category_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 连接查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> u.username, p.name <span style=color:#66d9ef>as</span> product_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> users u
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> orders o <span style=color:#66d9ef>ON</span> u.id <span style=color:#f92672>=</span> o.user_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> products p <span style=color:#66d9ef>ON</span> o.product_id <span style=color:#f92672>=</span> p.id;
</span></span></code></pre></div><h3 id=53-更新数据>5.3 更新数据<a hidden class=anchor aria-hidden=true href=#53-更新数据>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 更新单条记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>UPDATE</span> users <span style=color:#66d9ef>SET</span> email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;newemail@example.com&#39;</span> <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 更新多个字段
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>UPDATE</span> users <span style=color:#66d9ef>SET</span> 
</span></span><span style=display:flex><span>    email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;newemail@example.com&#39;</span>,
</span></span><span style=display:flex><span>    updated_at <span style=color:#f92672>=</span> NOW()
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 批量更新
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>UPDATE</span> products <span style=color:#66d9ef>SET</span> price <span style=color:#f92672>=</span> price <span style=color:#f92672>*</span> <span style=color:#ae81ff>1</span>.<span style=color:#ae81ff>1</span> <span style=color:#66d9ef>WHERE</span> category_id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span></code></pre></div><h3 id=54-删除数据>5.4 删除数据<a hidden class=anchor aria-hidden=true href=#54-删除数据>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 删除指定记录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 条件删除
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> created_at <span style=color:#f92672>&lt;</span> <span style=color:#e6db74>&#39;2022-01-01&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 删除所有记录（保留表结构）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><h2 id=6-索引操作>6. 索引操作<a hidden class=anchor aria-hidden=true href=#6-索引操作>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 创建索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>INDEX</span> idx_username <span style=color:#66d9ef>ON</span> users(username);
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>UNIQUE</span> <span style=color:#66d9ef>INDEX</span> idx_email <span style=color:#66d9ef>ON</span> users(email);
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>INDEX</span> idx_name_category <span style=color:#66d9ef>ON</span> products(name, category_id);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>INDEX</span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 删除索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>INDEX</span> index_name <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 分析表性能
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>EXPLAIN</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;john_doe&#39;</span>;
</span></span></code></pre></div><h2 id=7-用户和权限管理>7. 用户和权限管理<a hidden class=anchor aria-hidden=true href=#7-用户和权限管理>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 创建用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;newuser&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;password&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;remoteuser&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;%&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;password&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 授权
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> database_name.<span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>SELECT</span>, <span style=color:#66d9ef>INSERT</span>, <span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> GRANTS <span style=color:#66d9ef>FOR</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 撤销权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>REVOKE</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> database_name.<span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 刷新权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>FLUSH <span style=color:#66d9ef>PRIVILEGES</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 删除用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 修改密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;new_password&#39;</span>;
</span></span></code></pre></div><h2 id=8-备份和恢复>8. 备份和恢复<a hidden class=anchor aria-hidden=true href=#8-备份和恢复>#</a></h2><h3 id=81-数据备份>8.1 数据备份<a hidden class=anchor aria-hidden=true href=#81-数据备份>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 备份单个数据库</span>
</span></span><span style=display:flex><span>mysqldump -u username -p database_name &gt; backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 备份多个数据库</span>
</span></span><span style=display:flex><span>mysqldump -u username -p --databases db1 db2 &gt; backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 备份所有数据库</span>
</span></span><span style=display:flex><span>mysqldump -u username -p --all-databases &gt; all_backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 只备份表结构</span>
</span></span><span style=display:flex><span>mysqldump -u username -p --no-data database_name &gt; structure.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 只备份数据</span>
</span></span><span style=display:flex><span>mysqldump -u username -p --no-create-info database_name &gt; data.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 备份并压缩</span>
</span></span><span style=display:flex><span>mysqldump -u username -p database_name | gzip &gt; backup.sql.gz
</span></span></code></pre></div><h3 id=82-数据恢复>8.2 数据恢复<a hidden class=anchor aria-hidden=true href=#82-数据恢复>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 恢复数据库</span>
</span></span><span style=display:flex><span>mysql -u username -p database_name &lt; backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 恢复压缩备份</span>
</span></span><span style=display:flex><span>gunzip &lt; backup.sql.gz | mysql -u username -p database_name
</span></span></code></pre></div><h2 id=mysql-docker-容器管理>MySQL Docker 容器管理<a hidden class=anchor aria-hidden=true href=#mysql-docker-容器管理>#</a></h2><h3 id=91-运行mysql容器>9.1 运行MySQL容器<a hidden class=anchor aria-hidden=true href=#91-运行mysql容器>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 基本运行</span>
</span></span><span style=display:flex><span>docker run --name mysql-container -e MYSQL_ROOT_PASSWORD<span style=color:#f92672>=</span>rootpassword -d mysql:8.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定端口和数据卷</span>
</span></span><span style=display:flex><span>docker run --name mysql-container <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e MYSQL_ROOT_PASSWORD<span style=color:#f92672>=</span>rootpassword <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e MYSQL_DATABASE<span style=color:#f92672>=</span>myapp <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e MYSQL_USER<span style=color:#f92672>=</span>appuser <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e MYSQL_PASSWORD<span style=color:#f92672>=</span>apppassword <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -p 3306:3306 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v mysql-data:/var/lib/mysql <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d mysql:8.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用配置文件</span>
</span></span><span style=display:flex><span>docker run --name mysql-container <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e MYSQL_ROOT_PASSWORD<span style=color:#f92672>=</span>rootpassword <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -p 3306:3306 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v /path/to/my.cnf:/etc/mysql/my.cnf <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v mysql-data:/var/lib/mysql <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d mysql:8.0
</span></span></code></pre></div><h3 id=92-docker-compose-配置>9.2 Docker Compose 配置<a hidden class=anchor aria-hidden=true href=#92-docker-compose-配置>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># docker-compose.yml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.8&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>mysql</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>mysql:8.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>mysql-container</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>MYSQL_ROOT_PASSWORD</span>: <span style=color:#ae81ff>rootpassword</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>MYSQL_DATABASE</span>: <span style=color:#ae81ff>myapp</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>MYSQL_USER</span>: <span style=color:#ae81ff>appuser</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>MYSQL_PASSWORD</span>: <span style=color:#ae81ff>apppassword</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;3306:3306&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>mysql-data:/var/lib/mysql</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./mysql-config:/etc/mysql/conf.d</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./init-scripts:/docker-entrypoint-initdb.d</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>networks</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>app-network</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>mysql-data</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>networks</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>app-network</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>driver</span>: <span style=color:#ae81ff>bridge</span>
</span></span></code></pre></div><h3 id=93-容器管理命令>9.3 容器管理命令<a hidden class=anchor aria-hidden=true href=#93-容器管理命令>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 启动容器</span>
</span></span><span style=display:flex><span>docker start mysql-container
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 停止容器</span>
</span></span><span style=display:flex><span>docker stop mysql-container
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重启容器</span>
</span></span><span style=display:flex><span>docker restart mysql-container
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看容器状态</span>
</span></span><span style=display:flex><span>docker ps
</span></span><span style=display:flex><span>docker ps -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看容器日志</span>
</span></span><span style=display:flex><span>docker logs mysql-container
</span></span><span style=display:flex><span>docker logs -f mysql-container  <span style=color:#75715e># 实时查看</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 进入容器</span>
</span></span><span style=display:flex><span>docker exec -it mysql-container bash
</span></span><span style=display:flex><span>docker exec -it mysql-container mysql -u root -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除容器</span>
</span></span><span style=display:flex><span>docker rm mysql-container
</span></span><span style=display:flex><span>docker rm -f mysql-container  <span style=color:#75715e># 强制删除</span>
</span></span></code></pre></div><h3 id=94-数据备份和恢复docker>9.4 数据备份和恢复（Docker）<a hidden class=anchor aria-hidden=true href=#94-数据备份和恢复docker>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 备份数据库</span>
</span></span><span style=display:flex><span>docker exec mysql-container mysqldump -u root -prootpassword myapp &gt; backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 恢复数据库</span>
</span></span><span style=display:flex><span>docker exec -i mysql-container mysql -u root -prootpassword myapp &lt; backup.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 备份数据卷</span>
</span></span><span style=display:flex><span>docker run --rm -v mysql-data:/data -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/backup alpine tar czf /backup/mysql-backup.tar.gz -C /data .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 恢复数据卷</span>
</span></span><span style=display:flex><span>docker run --rm -v mysql-data:/data -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/backup alpine tar xzf /backup/mysql-backup.tar.gz -C /data
</span></span></code></pre></div><h2 id=10-性能优化和监控>10. 性能优化和监控<a hidden class=anchor aria-hidden=true href=#10-性能优化和监控>#</a></h2><h3 id=101-查看系统状态>10.1 查看系统状态<a hidden class=anchor aria-hidden=true href=#101-查看系统状态>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 查看MySQL版本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>VERSION</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看系统变量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> VARIABLES <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;innodb%&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHOW</span> VARIABLES <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;max_connections&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看系统状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> STATUS <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;Threads_connected&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHOW</span> STATUS <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;Slow_queries&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看进程列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> PROCESSLIST;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>FULL</span> PROCESSLIST;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看InnoDB状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> ENGINE INNODB STATUS;
</span></span></code></pre></div><h3 id=102-慢查询分析>10.2 慢查询分析<a hidden class=anchor aria-hidden=true href=#102-慢查询分析>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 开启慢查询日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>GLOBAL</span> slow_query_log <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ON&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>GLOBAL</span> long_query_time <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看慢查询配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> VARIABLES <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;slow_query%&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHOW</span> VARIABLES <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;long_query_time&#39;</span>;
</span></span></code></pre></div><h3 id=103-常用配置优化>10.3 常用配置优化<a hidden class=anchor aria-hidden=true href=#103-常用配置优化>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#75715e># my.cnf 配置示例</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[mysqld]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 基本配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>3306</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/var/lib/mysql/mysql.sock</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 字符集</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>character-set-server</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>utf8mb4</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>collation-server</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>utf8mb4_unicode_ci</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_connections</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>200</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_connect_errors</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 缓存配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_buffer_pool_size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>query_cache_size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>64M</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>query_cache_type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 日志配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log-error</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/var/log/mysql/error.log</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>slow_query_log</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>slow_query_log_file</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/var/log/mysql/slow.log</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>long_query_time</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># InnoDB配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_file_per_table</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_flush_log_at_trx_commit</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_log_buffer_size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>16M</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_log_file_size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>256M</span>
</span></span></code></pre></div><h2 id=11-常用工具和技巧>11. 常用工具和技巧<a hidden class=anchor aria-hidden=true href=#11-常用工具和技巧>#</a></h2><h3 id=111-mysql客户端工具>11.1 MySQL客户端工具<a hidden class=anchor aria-hidden=true href=#111-mysql客户端工具>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 使用mysql客户端</span>
</span></span><span style=display:flex><span>mysql -u username -p -h hostname -P port database_name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 执行SQL文件</span>
</span></span><span style=display:flex><span>mysql -u username -p database_name &lt; script.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 执行单条SQL命令</span>
</span></span><span style=display:flex><span>mysql -u username -p -e <span style=color:#e6db74>&#34;SELECT * FROM users LIMIT 5;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 输出为CSV格式</span>
</span></span><span style=display:flex><span>mysql -u username -p -e <span style=color:#e6db74>&#34;SELECT * FROM users;&#34;</span> --batch --raw | sed <span style=color:#e6db74>&#39;s/\t/,/g&#39;</span> &gt; output.csv
</span></span></code></pre></div><h3 id=112-实用技巧>11.2 实用技巧<a hidden class=anchor aria-hidden=true href=#112-实用技巧>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- 查看表大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>table_name</span>,
</span></span><span style=display:flex><span>    ROUND(((data_length <span style=color:#f92672>+</span> index_length) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>1024</span>), <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>AS</span> <span style=color:#e6db74>&#39;Size (MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> information_schema.tables 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> table_schema <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;database_name&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> (data_length <span style=color:#f92672>+</span> index_length) <span style=color:#66d9ef>DESC</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看数据库大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    table_schema <span style=color:#66d9ef>AS</span> <span style=color:#e6db74>&#39;Database&#39;</span>,
</span></span><span style=display:flex><span>    ROUND(<span style=color:#66d9ef>SUM</span>(data_length <span style=color:#f92672>+</span> index_length) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>AS</span> <span style=color:#e6db74>&#39;Size (MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> information_schema.tables 
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> table_schema;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 重置自增ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> AUTO_INCREMENT <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 查看表的自增值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>TABLE</span> STATUS <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;table_name&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 修复表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>REPAIR <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 优化表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>OPTIMIZE <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- 检查表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CHECK</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><h2 id=12-注意事项>12. 注意事项<a hidden class=anchor aria-hidden=true href=#12-注意事项>#</a></h2><ol><li><strong>安全第一</strong>：始终使用强密码，合理分配用户权限</li><li><strong>定期备份</strong>：制定备份策略，确保数据安全</li><li><strong>性能监控</strong>：定期检查慢查询，优化数据库性能</li><li><strong>容器化部署</strong>：使用Docker简化MySQL的部署和管理</li><li><strong>版本管理</strong>：保持MySQL版本更新，关注安全补丁</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://wellzhi.github.io/tags/mysql/>MySQL</a></li><li><a href=https://wellzhi.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/>数据库</a></li><li><a href=https://wellzhi.github.io/tags/docker/>Docker</a></li><li><a href=https://wellzhi.github.io/tags/%E5%91%BD%E4%BB%A4/>命令</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wellzhi.github.io/>wellzhi</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light"),theme=""):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),theme="dark"),mermaidTextContents.forEach((e,t)=>{document.getElementsByClassName("language-mermaid")[t].removeAttribute("data-processed"),document.getElementsByClassName("language-mermaid")[t].innerHTML=e}),mermaid.initialize({theme,startOnLoad:!0}),mermaid.init(void 0,".language-mermaid")})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>localStorage.getItem("pref-theme")=="dark"?theme="dark":theme="",mermaidTextContents=Array.from(document.getElementsByClassName("language-mermaid")).map(e=>e.innerHTML),mermaid.initialize({theme,startOnLoad:!0}),mermaid.init(void 0,".language-mermaid")</script></body></html>